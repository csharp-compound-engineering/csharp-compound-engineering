# yaml-language-server: $schema=./agent-schema.json
---
name: git-history-analyzer
description: Research agent that analyzes git history to find patterns, related changes, and identify subject matter experts
version: "1.0.0"

purpose: |
  The Git History Analyzer agent specializes in mining git repository history
  to understand how code has evolved, identify patterns of change, find related
  commits, and identify developers with expertise in specific areas.

  Use cases include:
  - Finding commits related to a specific feature or bug fix
  - Identifying which developers have expertise in certain areas
  - Understanding the evolution of a particular file or module
  - Finding when and why specific changes were introduced
  - Discovering patterns in how certain types of changes are made
  - Correlating code changes with project documentation

mcp_tools:
  - name: git_log
    description: Executes git log commands to retrieve commit history
    provider: git
    required: true
    parameters:
      args: "{{git_args}}"
      format: "{{format}}"

  - name: git_show
    description: Shows details of specific commits
    provider: git
    required: true
    parameters:
      commit: "{{commit_sha}}"

  - name: git_blame
    description: Shows line-by-line authorship information
    provider: git
    required: true
    parameters:
      file: "{{file_path}}"

  - name: git_diff
    description: Shows differences between commits or branches
    provider: git
    required: true
    parameters:
      from: "{{from_ref}}"
      to: "{{to_ref}}"

  - name: rag_query
    description: Queries project documentation to correlate with git history
    provider: cdocs
    required: true
    parameters:
      query: "{{query}}"
      maxResults: 10

  - name: semantic_search
    description: Searches for documentation related to commits or changes
    provider: cdocs
    required: true
    parameters:
      query: "{{query}}"
      docTypes:
        - problem
        - decision
        - insight

skills:
  - name: find_related_commits
    description: Find commits related to a specific topic, feature, or bug
    examples:
      - "Find all commits related to authentication implementation"
      - "Search for commits that modified the payment processing logic"
      - "Find commits mentioning issue #123"

  - name: identify_authors
    description: Identify developers with expertise in specific areas of the codebase
    examples:
      - "Who has the most expertise in the database layer?"
      - "Find the primary contributors to the API controllers"
      - "Identify experts for the caching implementation"

  - name: trace_evolution
    description: Trace the evolution of files, functions, or modules over time
    examples:
      - "How has the UserService class evolved over the past 6 months?"
      - "What changes have been made to the configuration system?"
      - "Trace the history of the error handling approach"

  - name: analyze_change_patterns
    description: Analyze patterns in how changes are typically made
    examples:
      - "What files typically change together with Controllers?"
      - "What's the typical pattern for adding a new entity?"
      - "How are database migrations typically paired with code changes?"

  - name: correlate_documentation
    description: Correlate git changes with project documentation
    examples:
      - "Find documentation related to commit abc123"
      - "Which decisions led to the changes in this file?"
      - "What problems were solved by changes in this timeframe?"

prompts:
  system: |
    You are a Git History Analyzer agent specialized in mining repository
    history for insights. Your role is to:

    1. Execute git commands to retrieve relevant history
    2. Analyze commit patterns and authorship
    3. Correlate code changes with project documentation
    4. Identify experts and knowledge owners
    5. Trace the evolution of code over time

    When analyzing:
    - Use appropriate git log filters for efficiency
    - Consider both commit messages and actual changes
    - Cross-reference with project documentation (problems, decisions)
    - Note significant milestones or refactoring efforts
    - Identify recurring patterns in change sets

    Output format:
    - Summary of findings with key commits
    - Timeline of significant changes
    - Author/expertise analysis when relevant
    - Links to related documentation
    - Recommendations or insights

  task_templates:
    find_commits: |
      Find commits related to: {{topic}}

      Search criteria:
      - Message contains: {{keywords}}
      - Files matching: {{file_patterns}}
      - Date range: {{date_range}}
      - Authors: {{authors}}

      Correlate with project documentation for context.

    expertise_analysis: |
      Analyze expertise for: {{area}}

      Consider:
      - Number of commits
      - Lines changed
      - Recency of contributions
      - Types of changes (features, fixes, refactoring)

      Provide ranked list of experts with justification.

    evolution_trace: |
      Trace evolution of: {{subject}}

      Time range: {{time_range}}
      Focus on:
      - Major milestones
      - Breaking changes
      - Refactoring efforts
      - Pattern shifts

      Include documentation references where available.

configuration:
  max_iterations: 20
  timeout_seconds: 240
  cache_results: true

metadata:
  author: compound-docs
  category: analysis
  tags:
    - git
    - history
    - analysis
    - expertise
    - evolution
    - commits
